<div class="container">
  <div class="content-wrapper">
    <!-- Left section: Store list -->
    <div class="left-section">
      <h2 class="title">Store Branches</h2>
      <ul class="store-list">
        <li *ngFor="let store of stores">
          <div class="store-info">
            <span class="store-name">{{ store.name }}</span>
            <span class="store-location">{{ store.city }}, {{ store.country }}</span>
          </div>
          <div class="store-actions">
            <button (click)="selectStore(store)" class="edit-btn">Edit</button>
            <button (click)="deleteStore(store.id!)" class="delete-btn">Delete</button>
          </div>
        </li>
      </ul>
    </div>

    <!-- Right section: Form and map -->
    <div class="right-section">
      <div class="address-card">
        <h2 class="card-title">{{ selectedStore ? 'Edit Store' : 'Add New Store' }}</h2>

        <!-- Search Box -->
        <div class="search-box">
          <input 
            type="text" 
            [formControl]="searchControl"
            placeholder="Search location and press Enter"
            class="form-input search-input"
            (keyup.enter)="onSearch()"
            [disabled]="isLoading"
          />
          <button 
            type="button" 
            (click)="onSearch()" 
            [disabled]="isLoading"
            class="search-btn"
            title="Search location"
          >
            üîç
          </button>
        </div>

        <form [formGroup]="storeForm" class="address-form">
          <div class="form-row">
            <div class="form-group">
              <label>Name</label>
              <input 
                type="text" 
                formControlName="name"
                placeholder="Store Name"
                class="form-input"
              />
            </div>
            <div class="form-group">
              <label>Phone Number</label>
              <input 
                type="text" 
                formControlName="phoneNumber"
                placeholder="Phone Number"
                class="form-input"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Full Address</label>
              <div class="input-wrapper">
                <input 
                  type="text" 
                  formControlName="fullAddress"
                  placeholder="Full Address"
                  class="form-input"
                />
                <button 
                  type="button" 
                  class="locate-btn" 
                  (click)="autoLocate()"
                  [disabled]="isLoading"
                  title="Auto locate">
                  <svg *ngIf="!isLoading" width="20" height="20" viewBox="0 0 24 24" fill="none">
                    <path d="M12 8C14.21 8 16 9.79 16 12C16 14.21 14.21 16 12 16C9.79 16 8 14.21 8 12C8 9.79 9.79 8 12 8ZM20.94 11C20.48 6.83 17.17 3.52 13 3.06V1H11V3.06C6.83 3.52 3.52 6.83 3.06 11H1V13H3.06C3.52 17.17 6.83 20.48 11 20.94V23H13V20.94C17.17 20.48 20.48 17.17 20.94 13H23V11H20.94ZM12 19C8.13 19 5 15.87 5 12C5 8.13 8.13 5 12 5C15.87 5 19 8.13 19 12C19 15.87 15.87 19 12 19Z" fill="currentColor"/>
                  </svg>
                  <div *ngIf="isLoading" class="loading-spinner"></div>
                </button>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>City</label>
              <input 
                type="text" 
                formControlName="city"
                placeholder="City"
                class="form-input"
              />
            </div>
            <div class="form-group">
              <label>Country</label>
              <input 
                type="text" 
                formControlName="country"
                placeholder="Country"
                class="form-input"
              />
            </div>
            <div class="form-group">
              <label>Zip Code</label>
              <input 
                type="text" 
                formControlName="zipCode"
                placeholder="Zip Code"
                class="form-input"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Latitude</label>
              <input
                type="number"
                formControlName="lat"
                placeholder="Latitude"
                class="form-input"
                step="any"
              />
            </div>
            <div class="form-group">
              <label>Longitude</label>
              <input
                type="number"
                formControlName="lng"
                placeholder="Longitude"
                class="form-input"
                step="any"
              />
            </div>
          </div>
        </form>

        <div class="map-container">
          <div id="map"></div>
        </div>

        <button 
          type="button" 
          class="save-btn" 
          (click)="saveStore()"
          [disabled]="!currentLatLng">
          {{ selectedStore ? 'Update Store' : 'Add Store' }}
        </button>
        <button 
          type="button" 
          class="cancel-btn" 
          *ngIf="selectedStore" 
          (click)="cancelEdit()">
          Cancel
        </button>
      </div>
    </div>
  </div>
</div>
